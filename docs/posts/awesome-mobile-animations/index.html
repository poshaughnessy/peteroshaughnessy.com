<!doctype html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <title>Awesome Mobile Animations - Peter O'Shaughnessy</title>
    <meta name="description" content="Web developer especially interested in web APIs and the future of the web">
    <link rel="stylesheet" href="/styles/styles.css"/>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700,400italic,700italic">
    <link rel="icon" href="/images/favicon.png" type="image/png">
    <link rel="alternate" type="application/rss+xml" title="RSS feed" href="https://peteroshaughnessy.com/rss.xml" />
    <!-- Twitter Card data -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@poshaughnessy">
    <meta name="twitter:creator" content="@poshaughnessy">
      <meta name="twitter:title" content="Awesome Mobile Animations">
      <meta name="twitter:description" content="Native apps and games are showing how mobile animations should be done. Here&#x27;s how to achieve similar results with the Web.">
      <meta name="twitter:image" content="https://peteroshaughnessy.com/images/posts/2014-06-08-awesome-mobile-animations/thumb-dots.jpg">
  </head>
  <body>
    <header>
      <div>
        <div class="avatar-container">
          <a href="/"><img class="avatar" src="/images/peter-cartoon-circle.png" alt="Peter's cartoon avatar"/></a>
        </div>
        <div class="title-and-tagline-container">
          <h1><a href="/">Peter O'Shaughnessy</a></h1>
          <h2>Web technologies and browser-based experiments</h2>
        </div>
      </div>
      <nav>
        <ul>
          <li><a href="/">Blog</a></li>
          <li><a href="/projects/">Projects</a></li>
          <li><a href="/talks/">Talks</a></li>
          <li><a href="/about/">About</a></li>
        </ul>
      </nav>
    </header>
<div class="contents">
  <article class="page page-post">
    <h1>Awesome Mobile Animations</h1>
    <p class="date"><time>8th Jun 2014</time></p>
    <p><em>Earlier this week I gave a talk at the <a href="http://www.meetup.com/EdTech-Developers-Meetup/events/184368552/">EdTech Developers
Meetup</a>. Here’s
the blog post version. You might also like to check out the
<a href="http://awesome-mobile-animations.herokuapp.com/">slides</a> and the
<a href="https://github.com/poshaughnessy/edtechdevs-awesome-mobile-animations">source
code</a>.</em></p>
<p>--</p>
<p>If you’ve been using apps and playing games on a modern smartphone
recently, you might have noticed something that the best ones all have
in common: <em>awesome animations</em>.</p>
<p>Take another look at your favourite apps and see how fluid they feel
when you navigate around. Most likely, they’ve ditched dull, linear
transitions and embraced fluent, charismatic motion.</p>
<p>For example, the game Dots uses this neat little effect throughout:</p>
<p><img src="/images/posts/2014-06-08-awesome-mobile-animations/dots.gif" alt="Dots animation"></p>
<p class="caption"><a href="http://capptivate.co">http://capptivate.co/</a></p>

<p>Just the addition of some acceleration, deceleration and a bounce effect
turns a lifeless movement into something fluid and life-like.</p>
<p>Little things add up, too. For example, Yelp uses this rocket ship for
their pull-to-refresh animation:</p>
<p><img src="/images/posts/2014-06-08-awesome-mobile-animations/yelp.gif" alt="Yelp animation"></p>
<p class="caption"><a href="http://capptivate.co">http://capptivate.co/</a></p>

<p>It might seem silly, but these little additions can help to surprise and
delight our users.</p>
<p>Animations can also be used to orientate your users. For example, Moldiv
uses this little animation to indicate how to access the menu:</p>
<p><img src="/images/posts/2014-06-08-awesome-mobile-animations/moldiv.gif" alt="Moldiv animation"></p>
<p class="caption"><a href="http://capptivate.co">http://capptivate.co/</a></p>

<p>Another example is the bounce effect when you tap the camera icon on the
iPhone lock screen; it informs you that you need to swipe up.</p>
<p>Good apps also keep their animations consistent. Take Facebook’s Paper,
for example. Here are some animations from different parts of the app,
but all the transitions use the same effect of stretching out slightly
further than their intended size, and then bouncing back:</p>
<p><img src="/images/posts/2014-06-08-awesome-mobile-animations/paper1.gif" alt="Paper animation 1"></p>
<p><img src="/images/posts/2014-06-08-awesome-mobile-animations/paper2.gif" alt="Paper animation 2"></p>
<p><img src="/images/posts/2014-06-08-awesome-mobile-animations/paper3.gif" alt="Paper animation 3"></p>
<p>So we can see that native mobile apps have been doing some awesome
things with animations recently. What about the Web?</p>
<p>It might be harder to achieve similarly smooth results with our
cross-platform Web technologies, but we’re seeing increasingly
impressive results.</p>
<p>Let’s take a look at some examples…</p>
<h2 id="css">CSS</h2>
<p>Here’s a neat demo of React.js-powered CSS transitions. In particular,
check out the menu effects from 0:43 and the photo gallery from 2:10:</p>
<p>Demo:
<a href="http://petehunt.github.io/react-touch">petehunt.github.io/react-touch</a></p>
<p>Three.js is well-known for making WebGL development much easier, but it
doesn’t just include a WebGLRenderer. It also has a CanvasRenderer, a
CSS3DRenderer and more… Here’s a demo from the creator MrDoob using the
CSS3DRenderer. It’s a take on famo.us’ periodic table:</p>
<p>Demo: <a href="http://bit.ly/css3d-per">http://bit.ly/css3d-per</a></p>
<p>CubeSlam is a very cool demo from Google and North Kingdom. On the
desktop, it uses WebGL via Three.js, but on mobile they’re using their
own CSS3D renderer:</p>
<p>Demo: <a href="https://www.cubeslam.com">https://www.cubeslam.com</a></p>
<p>About the tech: <a href="https://www.cubeslam.com/tech">https://www.cubeslam.com/tech</a></p>
<h2 id="canvas">Canvas</h2>
<p><a href="http://www.pixijs.com/">Pixi.js</a> is a fast graphics library for games
and interactive animations. One of the best things about it is that you
can set it up to use WebGL if it’s available (more on WebGL next), but
if it’s not, automatically fall back to using regular HTML5 Canvas. Even
Canvas without WebGL performs impressively fast though - just check out
their Run Pixie Run demo:</p>
<p>Demo: <a href="http://www.goodboydigital.com/runpixierun/">http://www.goodboydigital.com/runpixierun/</a></p>
<h2 id="webgl">WebGL</h2>
<p>Up until recently, WebGL hasn’t had great support from mobile browsers.
But it’s available with Chrome for Android, Firefox for Android and
Opera Mobile. And the big news just this week is that it’s coming to iOS
8!</p>
<p>Here’s a WebGL demo from Three.js. It runs really smoothly on my 2 year
old Galaxy Nexus phone:</p>
<p>Demo: <a href="http://threejs.org/examples/webgl_lines_sphere.html">http://threejs.org/examples/webgl_lines_sphere.html</a></p>
<p>Pixi.js’ <a href="http://www.goodboydigital.com/pixijs/bunnymark/">Bunnymark
demo</a> is really useful
to demonstrate the difference that WebGL makes. Here it is without WebGL - 
just using the regular 2D Canvas context:</p>
<iframe width="540" height="405" id="youtube_iframe" src="https://www.youtube.com/embed/5Mt65ktdHfU?feature=oembed&amp;enablejsapi=1&amp;wmode=opaque" frameborder="0"></iframe>

<p>And here you can see the difference when WebGL is enabled:</p>
<iframe width="540" height="405" id="youtube_iframe" src="https://www.youtube.com/embed/ZD9PvrLkqWc?feature=oembed&amp;enablejsapi=1&amp;wmode=opaque" frameborder="0"></iframe>

<p>Without WebGL, 1000 bunnies runs at 14 FPS (that’s sluggish). With
WebGL, we get a very healthy 58 FPS.</p>
<p>So there’s various Web technologies that can help us to achieve great
results, but we still need to be careful as developers and make sure we
make the best use of the browsers’ power. Let’s run through some general
tips:</p>
<h2 id="tips">Tips</h2>
<p><strong>1. For 60 frames per second, you only have 16ms to prepare each
frame</strong></p>
<p>60 frames per second is what we should be aiming for, to ensure a smooth
experience for our users. That’s equivalent to the screen refresh rate
of most mobile screens (60Hz) and good enough that our eyes won’t notice
any flicker.</p>
<p>A lower frame rate (down to around 30 FPS) may be acceptable in some
cases, but if we want the best performance, we should really aim for the
top end.</p>
<p>16ms, as it sounds, is not very long! So…</p>
<p><strong>2. Test, measure, optimise</strong></p>
<p>You’ll need to keep a close eye on how your animations are performing.
The debugging tools in your browser can provide the insights you need.
For example, Chrome’s Timeline tab lets you record all the browser
operations to do with rendering and see exactly how long they’re taking.</p>
<p>For a sense of how to use it, check out this video from Paul Irish where
he identifies a specific performance problem and how to fix it:</p>
<p>You can also use the <a href="http://updates.html5rocks.com/2012/08/When-milliseconds-are-not-enough-performance-now">High Resolution Time
API</a>
to accurately measure how long specific pieces of your code are taking.</p>
<p>Third party libraries can be useful too. For example,
<a href="https://github.com/mrdoob/stats.js/">stats.js</a> is a neat little FPS
counter that you can place in a corner of your viewport. Especially
handy for realtime performance measurement on mobile.</p>
<p><strong>3. For now, define animations in CSS if possible</strong></p>
<p>Until the new <a href="http://updates.html5rocks.com/2014/05/Web-Animations---element-animate-is-now-in-Chrome-36">Web Animations
API</a>
is available to use, you’ll get the best results if you can declare your
animations in CSS. The browser will be better able to optimise them,
running off the main UI thread and making use of the GPU.</p>
<p>Often you will need to control your animations with JavaScript though.
For example, you may need to cancel or alter it depending on user input.
You might wish to control it frame by frame. At the moment this can be
clunky, both in terms of the code we need to write and the way it
performs. That’s why the Web Animations API should be really helpful;
it’s designed to give us the control of JavaScript with the performance
of pure CSS.</p>
<p>Please don’t just default to using JQuery’s animate() method. It makes
heavy use of JavaScript and the performance differences can be dramatic.
Just take a look at this:</p>
<p><a href="http://css3.bradshawenterprises.com/blog/jquery-vs-css3-transitions/">http://css3.bradshawenterprises.com/blog/jquery-vs-css3-transitions/</a></p>
<p><strong>4. Make sure you don’t hammer the UI thread</strong></p>
<p>Unlike native development where it’s standard practice to keep
processing off from the UI thread, in JavaScript land we tend not to
think too much about this. Unfortunately that means it’s easy to
accidentally make our animations jerky or “janked”.</p>
<p>First of all, we should use
<a href="https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame">requestAnimationFrame</a>
when it’s available, rather than setInterval or setTimeout (although a
shim would need to fall back on one of those). This allows the browser
to tell us when it’s ready to prepare the next frame. That means we can
consistently run at the best frame rate the browser can manage, rather
than trying to force a particular frame rate and finding that the
browser either doesn’t keep up, or we don’t get the best out of it.</p>
<p>If you need to do a lot of processing, consider chunking it down and
performing it incrementally inside your requestAnimationFrame callback.
That way you can help ensure that you don’t go beyond that 16ms for each
frame.</p>
<p>Another option could be to move your processing into a <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Using_web_workers">Web
Worker</a>.</p>
<p><strong>5. Stick to: translate, scale, rotate, opacity</strong></p>
<p>There are four properties that a browser can animate “cheaply”:
translate, scale, rotate and opacity. Animate other things “at your own
risk”.</p>
<p>Observe the difference here between animating the ‘top’ and ‘left’
properties (the one on the left), versus using ‘translate’ (the one on
the right):</p>
<p>It really can make a very noticeable difference, on mobile devices
especially.</p>
<p><strong>6. Batch DOM operations</strong></p>
<p>Manipulating the DOM invalidates layouts, meaning the browser has to
perform reflows. So it’s best to avoid unnecessary DOM operations and to
batch up those that you do need to make.</p>
<p><a href="https://github.com/wilsonpage/fastdom">FastDOM</a> is a little library
that helps to batch DOM writes and reads. UI frameworks like
<a href="http://facebook.github.io/react/">React</a> and
<a href="http://www.ractivejs.org/">Ractive</a> can also handle this for you, by
providing a Virtual DOM. They can determine the minimal set of changes
that need to be made to the real DOM and modify it only at the best
times.</p>
<h2 id="awesome-mobile-web-animations-yes-we-can">Awesome mobile web animations? Yes we can</h2>
<p>The text from Pete Hunt’s React Touch demo sums things up nicely:</p>
<blockquote>
<p>“The web isn’t as performant as native, but on modern devices we can
get pretty close. Or at least a lot better than the Web’s current
reputation.”</p>
</blockquote>
<p>So let’s ditch those boring animations and make our mobile web apps more
fluid, and more awesome!</p>
<h2 id="further-reading">Further reading</h2>
<ul>
<li><a href="http://www.beyondkinetic.com/motion-ui-design-principles">Motion UI Design
Principles</a></li>
<li><a href="https://blog.prototypr.io/motion-design-is-the-future-of-ui-fc83ce55c02f#.x2627i8iq">Motion Design is the Future of UI</a></li>
<li><a href="http://www.html5rocks.com/en/tutorials/speed/high-performance-animations/">High Performance Animations
(HTML5 Rocks)</a></li>
<li><a href="http://www.html5rocks.com/en/tutorials/speed/rendering/">Jank Busting for Better Rendering Performance
(HTML5 Rocks)</a></li>
<li><a href="http://wilsonpage.co.uk/preventing-layout-thrashing/">Preventing Layout Thrashing
(Wilson Page)</a></li>
</ul>

      <p class="tags">
          <span>talks</span>
          <span> mobile</span>
          <span> performance</span>
          <span> ui</span>
      </p>
  </article>
</div>
    <footer>
      <p><a rel="me" href="https://toot.cafe/@peter">Mastodon</a> | <a rel="me" href="https://twitter.com/@poshaughnessy">Twitter</a> | <a href="https://github.com/poshaughnessy/">Github</a> | <a href="http://uk.linkedin.com/in/poshaughnessy/">LinkedIn</a> | <a href="https://github.com/poshaughnessy/peteroshaughnessy.com">Source</a> | <a href="rss.xml">RSS</a></p>
      <p>© 2019 Peter O'Shaughnessy</p>
    </footer>
  </body>
</html>
